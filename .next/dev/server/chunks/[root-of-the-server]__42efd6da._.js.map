{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/ies-task-/app/api/students/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\r\nimport { neon } from '@neondatabase/serverless'\r\n\r\nconst sql = neon(process.env.DATABASE_URL!)\r\n\r\nexport async function GET(request: NextRequest) {\r\n  try {\r\n    // Get query parameters\r\n    const { searchParams } = new URL(request.url)\r\n    const className = searchParams.get('class')\r\n    \r\n    let students\r\n    \r\n    if (className) {\r\n      // Filter by class if class parameter is provided\r\n      students = await sql`\r\n        SELECT * FROM students \r\n        WHERE class_name = ${className} \r\n        ORDER BY name ASC\r\n      `\r\n    } else {\r\n      // Get all students\r\n      students = await sql`\r\n        SELECT * FROM students \r\n        ORDER BY created_at DESC\r\n      `\r\n    }\r\n    \r\n    return NextResponse.json(students)\r\n  } catch (error) {\r\n    console.error('Error fetching students:', error)\r\n    return NextResponse.json(\r\n      { error: 'Failed to fetch students' },\r\n      { status: 500 }\r\n    )\r\n  }\r\n}\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const { name, class_name, email, status = 'Active' } = await request.json()\r\n    \r\n    if (!name || !class_name) {\r\n      return NextResponse.json(\r\n        { error: 'Name and class are required' },\r\n        { status: 400 }\r\n      )\r\n    }\r\n\r\n    // Validate status\r\n    const validStatuses = ['Active', 'Inactive']\r\n    if (!validStatuses.includes(status)) {\r\n      return NextResponse.json(\r\n        { error: 'Status must be either Active or Inactive' },\r\n        { status: 400 }\r\n      )\r\n    }\r\n\r\n    // Check if class exists\r\n    const [classExists] = await sql`\r\n      SELECT * FROM classes WHERE name = ${class_name}\r\n    `\r\n    \r\n    if (!classExists) {\r\n      return NextResponse.json(\r\n        { error: 'Class does not exist' },\r\n        { status: 400 }\r\n      )\r\n    }\r\n\r\n    const [newStudent] = await sql`\r\n      INSERT INTO students (name, class_name, email, status) \r\n      VALUES (${name}, ${class_name}, ${email}, ${status}) \r\n      RETURNING *\r\n    `\r\n    \r\n    return NextResponse.json(newStudent, { status: 201 })\r\n  } catch (error) {\r\n    console.error('Error creating student:', error)\r\n    return NextResponse.json(\r\n      { error: 'Failed to create student' },\r\n      { status: 500 }\r\n    )\r\n  }\r\n}"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEA,MAAM,MAAM,IAAA,gKAAI,EAAC,QAAQ,GAAG,CAAC,YAAY;AAElC,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,uBAAuB;QACvB,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAC5C,MAAM,YAAY,aAAa,GAAG,CAAC;QAEnC,IAAI;QAEJ,IAAI,WAAW;YACb,iDAAiD;YACjD,WAAW,MAAM,GAAG,CAAC;;2BAEA,EAAE,UAAU;;MAEjC,CAAC;QACH,OAAO;YACL,mBAAmB;YACnB,WAAW,MAAM,GAAG,CAAC;;;MAGrB,CAAC;QACH;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA2B,GACpC;YAAE,QAAQ;QAAI;IAElB;AACF;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,EAAE,IAAI,EAAE,UAAU,EAAE,KAAK,EAAE,SAAS,QAAQ,EAAE,GAAG,MAAM,QAAQ,IAAI;QAEzE,IAAI,CAAC,QAAQ,CAAC,YAAY;YACxB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA8B,GACvC;gBAAE,QAAQ;YAAI;QAElB;QAEA,kBAAkB;QAClB,MAAM,gBAAgB;YAAC;YAAU;SAAW;QAC5C,IAAI,CAAC,cAAc,QAAQ,CAAC,SAAS;YACnC,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA2C,GACpD;gBAAE,QAAQ;YAAI;QAElB;QAEA,wBAAwB;QACxB,MAAM,CAAC,YAAY,GAAG,MAAM,GAAG,CAAC;yCACK,EAAE,WAAW;IAClD,CAAC;QAED,IAAI,CAAC,aAAa;YAChB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAuB,GAChC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,CAAC,WAAW,GAAG,MAAM,GAAG,CAAC;;cAErB,EAAE,KAAK,EAAE,EAAE,WAAW,EAAE,EAAE,MAAM,EAAE,EAAE,OAAO;;IAErD,CAAC;QAED,OAAO,gJAAY,CAAC,IAAI,CAAC,YAAY;YAAE,QAAQ;QAAI;IACrD,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,2BAA2B;QACzC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA2B,GACpC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}