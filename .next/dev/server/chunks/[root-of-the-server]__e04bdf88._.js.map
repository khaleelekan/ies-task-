{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/ies-task-/app/api/students/%5Bid%5D/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\r\nimport { neon } from '@neondatabase/serverless'\r\n\r\nconst sql = neon(process.env.DATABASE_URL!)\r\n\r\nexport async function DELETE(\r\n  request: NextRequest,\r\n  { params }: { params: Promise<{ id: string }> } // Fix here too\r\n) {\r\n  try {\r\n    // Await the params\r\n    const { id } = await params\r\n    \r\n    // Check if student exists\r\n    const [existingStudent] = await sql`\r\n      SELECT * FROM students WHERE id = ${id}\r\n    `\r\n    \r\n    if (!existingStudent) {\r\n      return NextResponse.json(\r\n        { error: 'Student not found' },\r\n        { status: 404 }\r\n      )\r\n    }\r\n    \r\n    // Delete the student (this will cascade to attendance records)\r\n    await sql`DELETE FROM students WHERE id = ${id}`\r\n    \r\n    return NextResponse.json(\r\n      { message: 'Student deleted successfully' },\r\n      { status: 200 }\r\n    )\r\n  } catch (error) {\r\n    console.error('Error deleting student:', error)\r\n    return NextResponse.json(\r\n      { error: 'Failed to delete student' },\r\n      { status: 500 }\r\n    )\r\n  }\r\n}\r\n\r\n// Optional: Add PUT/PATCH for updating students\r\nexport async function PUT(\r\n  request: NextRequest,\r\n  { params }: { params: Promise<{ id: string }> } // Fix here too\r\n) {\r\n  try {\r\n    const { id } = await params\r\n    const { name, class_name, email, status } = await request.json()\r\n    \r\n    // Check if student exists\r\n    const [existingStudent] = await sql`\r\n      SELECT * FROM students WHERE id = ${id}\r\n    `\r\n    \r\n    if (!existingStudent) {\r\n      return NextResponse.json(\r\n        { error: 'Student not found' },\r\n        { status: 404 }\r\n      )\r\n    }\r\n    \r\n    // If changing class, check if new class exists\r\n    if (class_name && class_name !== existingStudent.class_name) {\r\n      const [classExists] = await sql`\r\n        SELECT * FROM classes WHERE name = ${class_name}\r\n      `\r\n      \r\n      if (!classExists) {\r\n        return NextResponse.json(\r\n          { error: 'Class does not exist' },\r\n          { status: 400 }\r\n        )\r\n      }\r\n    }\r\n    \r\n    // Update student\r\n    const [updatedStudent] = await sql`\r\n      UPDATE students \r\n      SET \r\n        name = COALESCE(${name}, name),\r\n        class_name = COALESCE(${class_name}, class_name),\r\n        email = COALESCE(${email}, email),\r\n        status = COALESCE(${status}, status),\r\n        updated_at = NOW()\r\n      WHERE id = ${id}\r\n      RETURNING *\r\n    `\r\n    \r\n    return NextResponse.json(updatedStudent)\r\n  } catch (error) {\r\n    console.error('Error updating student:', error)\r\n    return NextResponse.json(\r\n      { error: 'Failed to update student' },\r\n      { status: 500 }\r\n    )\r\n  }\r\n}"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEA,MAAM,MAAM,IAAA,gKAAI,EAAC,QAAQ,GAAG,CAAC,YAAY;AAElC,eAAe,OACpB,OAAoB,EACpB,EAAE,MAAM,EAAuC,CAAC,eAAe;AAAhB;IAE/C,IAAI;QACF,mBAAmB;QACnB,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM;QAErB,0BAA0B;QAC1B,MAAM,CAAC,gBAAgB,GAAG,MAAM,GAAG,CAAC;wCACA,EAAE,GAAG;IACzC,CAAC;QAED,IAAI,CAAC,iBAAiB;YACpB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAoB,GAC7B;gBAAE,QAAQ;YAAI;QAElB;QAEA,+DAA+D;QAC/D,MAAM,GAAG,CAAC,gCAAgC,EAAE,GAAG,CAAC;QAEhD,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,SAAS;QAA+B,GAC1C;YAAE,QAAQ;QAAI;IAElB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,2BAA2B;QACzC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA2B,GACpC;YAAE,QAAQ;QAAI;IAElB;AACF;AAGO,eAAe,IACpB,OAAoB,EACpB,EAAE,MAAM,EAAuC,CAAC,eAAe;AAAhB;IAE/C,IAAI;QACF,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM;QACrB,MAAM,EAAE,IAAI,EAAE,UAAU,EAAE,KAAK,EAAE,MAAM,EAAE,GAAG,MAAM,QAAQ,IAAI;QAE9D,0BAA0B;QAC1B,MAAM,CAAC,gBAAgB,GAAG,MAAM,GAAG,CAAC;wCACA,EAAE,GAAG;IACzC,CAAC;QAED,IAAI,CAAC,iBAAiB;YACpB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAoB,GAC7B;gBAAE,QAAQ;YAAI;QAElB;QAEA,+CAA+C;QAC/C,IAAI,cAAc,eAAe,gBAAgB,UAAU,EAAE;YAC3D,MAAM,CAAC,YAAY,GAAG,MAAM,GAAG,CAAC;2CACK,EAAE,WAAW;MAClD,CAAC;YAED,IAAI,CAAC,aAAa;gBAChB,OAAO,gJAAY,CAAC,IAAI,CACtB;oBAAE,OAAO;gBAAuB,GAChC;oBAAE,QAAQ;gBAAI;YAElB;QACF;QAEA,iBAAiB;QACjB,MAAM,CAAC,eAAe,GAAG,MAAM,GAAG,CAAC;;;wBAGf,EAAE,KAAK;8BACD,EAAE,WAAW;yBAClB,EAAE,MAAM;0BACP,EAAE,OAAO;;iBAElB,EAAE,GAAG;;IAElB,CAAC;QAED,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,2BAA2B;QACzC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA2B,GACpC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}